---
title: 指针
head:
- - meta
  - property: og:title
    content: 指针
- - meta
  - name: description
    content: 在 C 语言中，指针是一个非常重要的概念。指针是一个变量，其值为另一个变量的地址。使用指针可以访问和修改原变量的值，而指针的算术运算可以对数组进行操作。在使用指针时，需要注意指针的类型和指向的变量或数组的类型。掌握指针的使用方法和注意事项将有助于我们编写高效、稳定的 C 语言程序。
- - meta
  - name: keywords
    content: 指针，指针的定义，指针偏移，指针运算，指针传递
- - meta
  - property: og:description
    content: 在 C 语言中，指针是一个非常重要的概念。指针是一个变量，其值为另一个变量的地址。使用指针可以访问和修改原变量的值，而指针的算术运算可以对数组进行操作。在使用指针时，需要注意指针的类型和指向的变量或数组的类型。掌握指针的使用方法和注意事项将有助于我们编写高效、稳定的 C 语言程序。
---

## 指针

在 C 语言中，指针是一种特殊的变量类型，它存储了一个内存地址，即某个变量在内存中的位置。可以通过指针访问该变量，并对其进行操作。

## 定义和声明

定义指针需要使用 `*` 运算符，如

```c
int *p; //定义一个整型指针 p
char *q; //定义一个字符型指针 q
```

声明指针则需要使用“&”运算符取得变量的地址：

```c
int a = 10;
int *p = &a; //将 a 的地址赋值给 p
```

## 指针操作

### 解引用

使用 `*` 运算符解引用一个指针，可以访问该指针所指向的值。

```c
#include <stdio.h>

int main() {
    int a = 10;
    int *p = &a;
    printf("%d", *p); // 输出10
}
```

指针操作示例

```c
#include <stdio.h>

int main() {
    int a = 5;
    int b = 20;
    int *p;  // 定义指向整型变量的指针
    p = &a;  // 将指针指向变量 a 的地址
    printf("The value of a is %p.\n", p);  // 打印指针指向的内存地址
    printf("The value of a is %d.\n", *p); // 通过指针访问变量 a 的值
    *p = 10;
    printf("The value of a is %d.\n", *p); // 通过指针改变 a 的值，并访问
    printf("The value of a is %d.\n", a);  // 访问变量 a 的值，a 的值随着指针的操作也发生了变化

    p = &b;
    printf("The value of a is %d.\n", *p); // 通过该表指针的地址，新的地址中存储的值变成了 b 的值
    printf("The value of a is %d.\n", a);  // 访问变量 a 的值，发现 a 的值没有变化, 因为指针已经解绑了指向 a 的地址
}
```

## 指针与 const

const 关键字可以用于指针的不同位置，从而影响指针的使用方式。

### 指针常量

指针常量表示指针本身是个常量，一旦被赋值，其指向的地址不可修改，但是可以修改地址中存储的值。便于记忆，我们观察到常量指针符号在前面，关键字在后面，因此按顺序读叫做指针常量。

```c
数据类型 * const 指针变量名;
```

::: tip
指针是个常量；
指针所保存的地址可以改变，然而指针所指向的值却不可以改变；
指针本身是常量，指向的地址不可以变化，但是指向的地址所对应的内容可以变化。
使用前要初始化
:::


```c
#include <stdio.h>

int main(){
    int a = 10, b= 5;
    int * const p = &a;
    p = &b; // error: assignment of read-only variable 'p'
    *p = 20;
}
```

### 常量指针

常量指针表示指针指向的数据是被 const 修饰的变量。 便于记忆，我们观察到常量关键字在前面，指针符号在后面，因此按顺序读叫做常量指针。

```c
const 指针类型 * 指针变量名;
指针类型 const * 指针变量名;
```

::: tip 
常量指针指向的对象不能通过这个指针来修改，可是仍然可以通过原来的声明修改；
常量指针可以被赋值为变量的地址，之所以叫常量指针，是限制了通过这个指针修改变量的值；
指针还可以指向别处，因为指针本身只是个变量，可以指向任意地址。
:::


```c
#include <stdio.h>

int main(){
    const int * p;
    int a = 10;
    p = &a;
    *p = 20; // Read-only variable is not assignable

    int const * q;
    q = &a;
    *q = 20; // Read-only variable is not assignable
    
    int b = 5;
    // 指针可以再次指向别的地址
    p = &b;
    q = &b;
}
```

### 指向常量的常指针

```c
const 数据类型 * const 指针变量;
数据类型 const * const 指针变量;
```

常量指针不允许修改指针地址中存储的常量; 指针常量不允许将指针本身指向别处; 而指向常量的常指针则代表指针本身和常量都不允许被修改。

```c
int a = 10, b= 5;
const int * const p = &a; // p 是一个指向常量整数的常量指针，即指针和指向的对象都是常量
*p = 20;                  // 错误：不能通过 p 修改 a 的值，因为指针指向的是常量
p = &b;                   // 错误：指针是常量，无法改变指向的地址
```

### 指针偏移

当一个数组被声明时，它会在内存中占据一段连续的空间。因此，可以使用数组名来获取第一个元素的地址，并通过加上偏移量来获取后面元素的地址。

```c
#include <stdio.h>

int main() {
    int arr[5] = {1, 3, 5, 7, 9};
    int *p = &arr[0]; // p 指向 arr[0]
    printf("%d\n", *(p+2)); // 输出 5
}
```

### 指针传递

指针也可以作为参数传递给函数，从而让函数能够直接修改指针所指向的值。

```c
#include <stdio.h>

int main() {
    void swap(int *a, int *b) {
        int tmp = *a;
        *a = *b;
        *b = tmp;
    }
    
    int main() {
        int x = 1, y = 2;
        swap(&x, &y);
        printf("%d %d", x, y); // 输出2 1
    }
}
```
    
### 总结

在 C 语言中，指针是一个非常重要的概念。指针是一个变量，其值为另一个变量的地址。使用指针可以访问和修改原变量的值，而指针的算术运算可以对数组进行操作。在使用指针时，需要注意指针的类型和指向的变量或数组的类型。掌握指针的使用方法和注意事项将有助于我们编写高效、稳定的 C 语言程序。

